※2016年あたりに作ったもののアーカイブ。もし利用する際は自己責任にてご利用ください。

---

README - WebEditor
==================

## これは何？

* ブラウザ上で共同編集できるWebページ制作用エディタです。
* エディタへの変更は他の参加者と即時同期されます。
* HTML、Sass（.scss）、JavaScriptに対応しています。
* Sass(.scss)のライブトランスパイルが可能です。
* ライブプレビューがあります。
* エディタのテーマ、レイアウト、フォントサイズが僅かですが選択可能です。
* 1つのサーバで複数のエディタが同時に利用可能です。
* サーバはエディタ内のデータを保持しません。
* ローカルネットワークで完結しています。外部との通信は不要です。


## 使用しているもの

* Node.js 8.5.0
	* [Express.js](http://expressjs.com/ja/) 4.16.1  
	  Node.jsベースのWebサーバ作成を簡略化してくれます。
	* [socket.io](https://socket.io/) 1.0.0  
	  リアルタイム通信を簡単に実現できます。
* [Ace Editor](https://ace.c9.io/)  
  JavaScriptで作られたWebブラウザ上で動作するエディタです。
* [sass.js](https://github.com/medialize/sass.js/)  
  JavaScriptで作られたSassトランスパイラです。  
  [Sass - Wikipedia](https://ja.wikipedia.org/wiki/Sass)


## 利用方法（サーバ）

> 以下は`Node.js`、`npm`がインストール済みであり、npmがプロキシを通過できることを前提としています。  
> また、既に動作しているサーバが存在する場合はこの項目は読み飛ばしてください。

ファイル一式を適当な場所に配置し、コマンドプロンプトを開きカレントディレクトリとした上で以下を実行します。  
`index.js`が存在するフォルダを開き、何もないところで`Shift + 右クリック`し、`コマンドプロンプトをここで開く`を選択すると簡単です。

```bat
npm install  
node index.js
```

`Ctrl + c`でスクリプトを停止、またはコマンドプロンプトを閉じるとサーバは終了します。


## 利用方法（クライアント）

### 共同編集できるエディタの作成
ブラウザ（Internet Explorerを除く）で以下にアクセスします。

```
http://サーバの動作しているIPアドレス:3000/
```

最初のアクセスで、末尾にランダムな文字列を付加したURLにリダイレクトされます。  
リダイレクト後のURLは一つの部屋となり、同じURLにアクセスした人とのみエディタが同期されます。  
`末尾文字列 ＝ 部屋番号`のようなイメージになります。

また、以下の形式でアクセスすることでも一意のエディタが生成できます。

```
http://サーバの動作しているIPアドレス:3000/任意の文字列
```

### エディタの利用

`.html`、`.scss`、`.js`の領域に文字を入力することで、Preview領域にそれらが反映されます。  
それぞれの言語に適したハイライトが設定されています。  
`.css`領域は編集不可ですが、`.scss`領域にCSSやScssを適切に記述することで自動的に変換結果が表示されます。

上部の各種設定は同期されず、個人の設定となります。

「プレビューモード」のチェックボックスのオン・オフにより、Preview領域が最大化・縮小されます。


## 既知の問題

* Internet Explorerでは動作しません。
	* Preview領域のstyle、書き出しに使用している`innerHTML`の挙動を確認できていないためです。
* レイアウト変更時、エディタの一部領域が表示されない場合があります。
* Scssのキーワードハイライトが不十分である可能性があります。
	* Ace Editorの言語設定ファイルに依存します。
* Preview更新時に、ページ幅と高さが画面より大きくなる場合があります。
* 参加者数が不正な数値になる場合があります。
* スマートフォンでの表示は考慮していません。
	* 一応Android版Firefoxでの動作は確認していますが、スマートフォンでの利用は現実的ではないと判断したため対応予定も今のところありません。
	* 画面幅で判定し、Preview onlyモードにする可能性はあります。

